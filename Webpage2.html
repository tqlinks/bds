<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Web Qu·∫£n L√Ω & T√¨m Ki·∫øm B·∫•t ƒê·ªông S·∫£n Offline</title>
    <style>
        /* ======================================================= */
        /* CSS CHO GIAO DI·ªÜN */
        /* ======================================================= */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        .container {
            display: flex;
            gap: 20px;
            max-width: 1200px;
            margin: auto;
        }
        .column {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .column-left {
            flex: 1.5;
        }
        .column-right {
            flex: 2;
        }
        h2 {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group input[type="file"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        /* Style cho khu v·ª±c l·ªçc t√¨m ki·∫øm */
        .filter-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .filter-item {
            flex: 1;
            min-width: 150px;
        }
        .filter-item input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        /* Style n√∫t */
        button {
            background-color: #28a745;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #218838;
        }
        /* Style danh s√°ch k·∫øt qu·∫£ */
        #results-list {
            list-style: none;
            padding: 0;
        }
        .property-item {
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 15px;
            padding: 15px;
            display: flex;
            gap: 15px;
            align-items: center;
            background-color: #fafafa;
        }
        .property-item img {
            max-width: 120px;
            height: auto;
            border-radius: 4px;
            object-fit: cover;
        }
        .property-info {
            flex-grow: 1;
        }
        .property-info p {
            margin: 5px 0;
        }
        .property-info strong {
            color: #0056b3;
        }
    </style>
</head>
<body>

<div class="container">

    <div class="column column-left">
        <h2>‚ûï Nh·∫≠p Th√¥ng Tin B·∫•t ƒê·ªông S·∫£n</h2>
        <form id="property-form">
            <div class="form-group">
                <label for="name">T√™n / Ti√™u ƒë·ªÅ:</label>
                <input type="text" id="name" required placeholder="V√≠ d·ª•: CƒÉn h·ªô cao c·∫•p Qu·∫≠n 1">
            </div>
            <div class="form-group">
                <label for="phone">S·ªë ƒëi·ªán tho·∫°i:</label>
                <input type="text" id="phone" required placeholder="090...">
            </div>
            <div class="form-group">
                <label for="address">ƒê·ªãa ch·ªâ:</label>
                <input type="text" id="address" required placeholder="123 ƒê∆∞·ªùng ABC, Ph∆∞·ªùng X, Qu·∫≠n Y">
            </div>
            <div class="form-group">
                <label for="price">Gi√° (VNƒê/t·ª∑):</label>
                <input type="number" id="price" step="0.01" required placeholder="V√≠ d·ª•: 3.5 (t·ª∑)">
            </div>
            <div class="form-group">
                <label for="area">Di·ªán t√≠ch (m¬≤):</label>
                <input type="number" id="area" step="0.1" required placeholder="V√≠ d·ª•: 80.5">
            </div>
            <div class="form-group">
                <label for="image-upload">H√¨nh ·∫£nh:</label>
                <input type="file" id="image-upload" accept="image/*" required>
            </div>
            
            <div class="form-group" id="preview-area">
                <label>Xem tr∆∞·ªõc ·∫£nh ƒë√£ ch·ªçn:</label>
                <img id="image-preview" src="#" alt="Xem tr∆∞·ªõc ·∫£nh" style="max-width: 100%; height: auto; margin-top: 10px; border: 1px solid #ddd; display: none;">
            </div>
            
            <button type="submit">L∆∞u Th√¥ng Tin</button>
        </form>
        <p style="margin-top: 15px; font-size: 0.9em; color: #6c757d;">*D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr·ªØ c·ª•c b·ªô trong tr√¨nh duy·ªát c·ªßa b·∫°n (LocalStorage).</p>
    </div>

    <div class="column column-right">
        <h2>üîç T√¨m Ki·∫øm Chi Ti·∫øt</h2>
        
        <div class="filter-group">
            <div class="filter-item">
                <label for="filter-name">T√™n / Ti√™u ƒë·ªÅ:</label>
                <input type="text" id="filter-name" placeholder="T√¨m ki·∫øm theo T√™n..." onkeyup="searchProperties()">
            </div>
            <div class="filter-item">
                <label for="filter-phone">S·ªë ƒëi·ªán tho·∫°i:</label>
                <input type="text" id="filter-phone" placeholder="T√¨m ki·∫øm theo SƒêT..." onkeyup="searchProperties()">
            </div>
            <div class="filter-item">
                <label for="filter-address">ƒê·ªãa ch·ªâ:</label>
                <input type="text" id="filter-address" placeholder="T√¨m ki·∫øm theo ƒê·ªãa ch·ªâ..." onkeyup="searchProperties()">
            </div>
        </div>
        
        <div class="filter-group">
            <div class="filter-item">
                <label for="filter-price-min">Gi√° th·∫•p nh·∫•t (t·ª∑ VNƒê):</label>
                <input type="number" id="filter-price-min" step="0.01" placeholder="Min Gi√°..." onkeyup="searchProperties()">
            </div>
            <div class="filter-item">
                <label for="filter-price-max">Gi√° cao nh·∫•t (t·ª∑ VNƒê):</label>
                <input type="number" id="filter-price-max" step="0.01" placeholder="Max Gi√°..." onkeyup="searchProperties()">
            </div>
            <div class="filter-item">
                <label for="filter-area-min">Di·ªán t√≠ch t·ªëi thi·ªÉu (m¬≤):</label>
                <input type="number" id="filter-area-min" step="0.1" placeholder="Min Di·ªán t√≠ch..." onkeyup="searchProperties()">
            </div>
        </div>
        
        <h3>Danh s√°ch K·∫øt qu·∫£</h3>
        <ul id="results-list">
            </ul>
    </div>

</div>

<script>
    // =======================================================
    // JAVASCRIPT: LOGIC V√Ä L∆ØU TR·ªÆ OFFLINE (LOCALSTORAGE)
    // =======================================================

    // 1. T·∫¢I D·ªÆ LI·ªÜU ƒê√É L∆ØU T·ª™ LOCALSTORAGE
    let properties = JSON.parse(localStorage.getItem('properties')) || [];

    // H√†m l∆∞u tr·ªØ d·ªØ li·ªáu v√†o LocalStorage
    function saveProperties() {
        localStorage.setItem('properties', JSON.stringify(properties));
    }
    
    // H√†m x·ª≠ l√Ω xem tr∆∞·ªõc ·∫£nh
    function previewImage() {
        const fileInput = document.getElementById('image-upload');
        const preview = document.getElementById('image-preview');
        const file = fileInput.files[0];

        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
            }
            reader.readAsDataURL(file);
        } else {
            preview.src = '#';
            preview.style.display = 'none';
        }
    }
    
    // L·∫ÆNG NGHE S·ª∞ KI·ªÜN CH·ªåN ·∫¢NH
    document.getElementById('image-upload').addEventListener('change', previewImage);


    // X·ª≠ l√Ω Form n·ªôp d·ªØ li·ªáu
    document.getElementById('property-form').addEventListener('submit', function(e) {
        e.preventDefault();

        const name = document.getElementById('name').value;
        const phone = document.getElementById('phone').value;
        const address = document.getElementById('address').value;
        const price = parseFloat(document.getElementById('price').value);
        const area = parseFloat(document.getElementById('area').value);
        const imageFile = document.getElementById('image-upload').files[0];

        const reader = new FileReader();
        reader.onload = function(event) {
            const imageBase64 = event.target.result;

            const newProperty = {
                id: Date.now(),
                name: name,
                phone: phone,
                address: address,
                price: price,
                area: area,
                image: imageBase64
            };

            properties.push(newProperty);
            saveProperties(); // <<< L∆ØU D·ªÆ LI·ªÜU M·ªöI

            alert('ƒê√£ l∆∞u th√¥ng tin b·∫•t ƒë·ªông s·∫£n th√†nh c√¥ng!');

            // Reset form v√† ·∫©n ·∫£nh xem tr∆∞·ªõc
            document.getElementById('property-form').reset();
            document.getElementById('image-preview').style.display = 'none';
            
            searchProperties();
        };

        if (imageFile) {
            reader.readAsDataURL(imageFile);
        }
    });

    // H√†m t√¨m ki·∫øm v√† l·ªçc chi ti·∫øt
    function searchProperties() {
        // L·∫•y gi√° tr·ªã t·ª´ c√°c √¥ l·ªçc
        const filterName = document.getElementById('filter-name').value.toLowerCase();
        const filterPhone = document.getElementById('filter-phone').value.toLowerCase();
        const filterAddress = document.getElementById('filter-address').value.toLowerCase();
        
        const filterPriceMin = parseFloat(document.getElementById('filter-price-min').value); 
        const filterPriceMax = parseFloat(document.getElementById('filter-price-max').value); 
        const filterAreaMin = parseFloat(document.getElementById('filter-area-min').value); 

        const resultsList = document.getElementById('results-list');
        resultsList.innerHTML = ''; // X√≥a k·∫øt qu·∫£ c≈©

        // L·ªçc danh s√°ch t√†i s·∫£n d·ª±a tr√™n t·∫•t c·∫£ c√°c ti√™u ch√≠
        const filteredProperties = properties.filter(prop => {
            // 1. L·ªçc theo Chu·ªói (T√™n, SƒêT, ƒê·ªãa ch·ªâ)
            const matchName = prop.name.toLowerCase().includes(filterName);
            const matchPhone = prop.phone.toLowerCase().includes(filterPhone);
            const matchAddress = prop.address.toLowerCase().includes(filterAddress);
            
            // 2. L·ªçc theo Gi√° (Ph·∫°m vi)
            const matchPriceMin = isNaN(filterPriceMin) || prop.price >= filterPriceMin; 
            const matchPriceMax = isNaN(filterPriceMax) || prop.price <= filterPriceMax; 
            const matchPrice = matchPriceMin && matchPriceMax;
            
            // 3. L·ªçc theo Di·ªán t√≠ch
            const matchArea = isNaN(filterAreaMin) || prop.area >= filterAreaMin;
            
            // Tr·∫£ v·ªÅ true n·∫øu t·∫•t c·∫£ c√°c ƒëi·ªÅu ki·ªán ƒë·ªÅu ƒë√∫ng
            return matchName && matchPhone && matchAddress && matchPrice && matchArea;
        });

        if (filteredProperties.length === 0) {
            resultsList.innerHTML = '<p style="text-align: center; color: #dc3545;">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o ph√π h·ª£p.</p>';
            return;
        }

        // Hi·ªÉn th·ªã t·ª´ng k·∫øt qu·∫£
        filteredProperties.forEach(prop => {
            const listItem = document.createElement('li');
            listItem.className = 'property-item';
            
            // ƒê·ªãnh d·∫°ng gi√° tr·ªã
            const formattedPrice = prop.price.toLocaleString('vi-VN', { minimumFractionDigits: 2 }) + ' t·ª∑ VNƒê';
            const formattedArea = prop.area.toLocaleString('vi-VN', { minimumFractionDigits: 1 }) + ' m¬≤';

            listItem.innerHTML = `
                <img src="${prop.image}" alt="${prop.name}">
                <div class="property-info">
                    <p><strong>${prop.name}</strong></p>
                    <p>ƒê·ªãa ch·ªâ: ${prop.address}</p>
                    <p>üìû ${prop.phone}</p>
                    <p>üí∞ Gi√°: <strong>${formattedPrice}</strong></p>
                    <p>üìê Di·ªán t√≠ch: ${formattedArea}</p>
                </div>
            `;
            resultsList.appendChild(listItem);
        });
    }

    // T·∫¢I D·ªÆ LI·ªÜU V√Ä HI·ªÇN TH·ªä KHI TRANG LOAD XONG
    document.addEventListener('DOMContentLoaded', searchProperties);
</script>

</body>
</html>